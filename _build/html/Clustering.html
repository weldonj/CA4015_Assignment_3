
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1. Setup &#8212; CA4015 Assignment 1 - John Weldon, Liam Carroll, Nathan Crone</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Summary" href="Summary_Conclusion.html" />
    <link rel="prev" title="INTRODUCTION AND DESCRIPTION OF DATASET" href="Intro_and_Desc_of_Data.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/k-means.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">CA4015 Assignment 1 - John Weldon, Liam Carroll, Nathan Crone</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_and_Desc_of_Data.html">
   INTRODUCTION AND DESCRIPTION OF DATASET
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Clustering Work
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Setup
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#read-in-the-data">
   2. Read in the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#standardise-the-data">
   3. Standardise the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#consideration-of-clustering-algorithms-and-optimal-number-of-clusters">
   4. Consideration of clustering algorithms and optimal number of clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#cluster-the-data-using-2-clusters">
   5. Cluster the data using 2 clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#analyse-these-2-clusters">
   6. Analyse these 2 clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#re-consider-the-clustering-algorithms-and-the-number-of-clusters">
   7. Re-consider the clustering algorithms and the number of clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#re-cluster-the-data-using-6-clusters">
   8. Re-cluster the data using 6 clusters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#principal-component-analysis">
   9. Principal Component Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#plot-the-6-clusters-using-the-pca-axes">
   10. Plot the 6 clusters using the PCA axes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#analyse-these-6-clusters">
   11. Analyse these 6 clusters
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Concluding Section
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Summary_Conclusion.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Summary_Conclusion.html#learning-outcomes">
   Learning Outcomes
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="References.html">
   References
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Clustering.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Clustering.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/Clustering.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   1. Setup
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#importing-relevant-libraries">
     Importing Relevant Libraries
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#general">
       General
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-scaling-the-data">
       For scaling the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-clustering">
       For clustering
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-principal-component-analysis">
       For principal component analysis
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#for-plotting">
       For plotting
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-in-the-data">
   2. Read in the data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-pvl-delta-model">
     Read in data from PVL-Delta model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#inspect-the-data">
       Inspect the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#processing">
       Processing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-the-orl-model">
     Read in data from the ORL model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Inspect the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Processing
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data-from-the-vpp-model">
     Read in data from the VPP model
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Inspect the data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Processing
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#standardise-the-data">
   3. Standardise the data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choose-which-data-source-to-use">
     Choose which data source to use
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualising-the-distributions-of-the-different-variables">
     Visualising the distributions of the different variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scaling-and-normalising-the-features">
     Scaling and normalising the features
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-group-feature-back-in">
     Add the group feature back in
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#consideration-of-clustering-algorithms-and-optimal-number-of-clusters">
   4. Consideration of clustering algorithms and optimal number of clusters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choose-the-number-of-clusters-to-test-these-algorithms-on">
     Choose the number of clusters to test these algorithms on
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choose-the-random-seed-number-for-reproducibility">
     Choose the random seed number for reproducibility
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#define-the-functions-for-calculating-the-silhouette-scores-of-the-different-models">
     Define the functions for calculating the silhouette scores of the different models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#silhouette-scores-for-the-kmeans-algorithm">
     Silhouette Scores for the KMeans Algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#use-k-means-to-calculate-the-silhouette-score-for-2-10-clusters">
       Use K-Means to calculate the Silhouette Score for 2-10 clusters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analyse-these-scores-and-output-plot-the-score">
       Analyse these scores and output &amp; plot the score
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#silhouette-scores-for-the-spectral-clustering-algorithm">
     Silhouette Scores for the Spectral Clustering Algorithm
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-clustering-with-affinity-rbf">
       Spectral Clustering with
       <em>
        affinity=’rbf’
       </em>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#use-spectral-clustering-to-calculate-the-silhouette-score-for-2-10-clusters">
         Use Spectral Clustering to calculate the Silhouette Score for 2-10 clusters
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id5">
         Analyse these scores and output &amp; plot the score
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-clustering-with-affinity-nearest-neighbors">
       Spectral Clustering with
       <em>
        affinity=’nearest_neighbors’
       </em>
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id6">
         Use Spectral Clustering to calculate the Silhouette Score for 2-10 clusters
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#id7">
         Analyse these scores and output &amp; plot the score
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#choose-the-number-of-clusters-to-use">
         Choose the number of clusters to use
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cluster-the-data-using-2-clusters">
   5. Cluster the data using 2 clusters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-the-rbf-spectral-clustering-model-with-these-2-clusters">
     Build the ‘rbf’ spectral clustering model with these 2 clusters
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#training-the-model-and-storing-predicted-cluster-labels">
     Training the model and storing predicted cluster labels
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#turn-this-array-to-a-dataframe-so-it-can-be-concatenated-with-the-rest-of-the-data">
     Turn this array to a dataframe so it can be concatenated with the rest of the data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-a-new-column-to-the-original-data-with-the-cluster-each-data-point-is-in">
     Add a new column to the original data with the cluster each data point is in
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-these-2-clusters">
   6. Analyse these 2 clusters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-function-to-see-how-the-young-and-old-people-are-distributed-within-each-cluster">
     Create function to see how the young and old people are distributed within each cluster
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-the-distribution-of-young-and-old-people-among-the-2-clusters">
     Check the distribution of young and old people among the 2 clusters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#re-consider-the-clustering-algorithms-and-the-number-of-clusters">
   7. Re-consider the clustering algorithms and the number of clusters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-function-to-output-the-silhoette-scores-excluding-two-clusters">
     Create function to output the silhoette scores excluding two clusters
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#silhouette-scores-for-the-kmeans-algorithm-excluding-two-clusters">
     Silhouette Scores for the KMeans Algorithm (excluding two clusters)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#silhouette-scores-for-spectral-clustering-algorithm-excluding-two-clusters">
     Silhouette Scores for Spectral Clustering Algorithm (excluding two clusters)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-clustering-with-affinity-rbf-excluding-two-clusters">
       Spectral Clustering with
       <em>
        affinity=’rbf’
       </em>
       (excluding two clusters)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spectral-clustering-with-affinity-nearest-neighbors-excluding-two-clusters">
       Spectral Clustering with
       <em>
        affinity=’nearest_neighbors’
       </em>
       (excluding two clusters)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#further-verification-of-optimal-number-of-clusters-using-elbow-curve-of-distortions">
     Further verification of optimal number of clusters using elbow curve of distortions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculate-distortion-scores-for-different-numbers-of-clusters">
       Calculate distortion scores for different numbers of clusters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-elbow-curve-of-the-distortion-that-each-cluster-gives">
       Plot the elbow curve of the distortion that each cluster gives
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#re-choose-the-number-of-clusters">
       Re-choose the number of clusters
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#re-cluster-the-data-using-6-clusters">
   8. Re-cluster the data using 6 clusters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#building-the-kmeans-model-and-clustering-the-data">
     Building the KMeans model and clustering the data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Training the model and storing predicted cluster labels
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-the-centroids-of-these-clusters">
     Get the centroids of these clusters
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#turn-the-labels-array-into-a-dataframe-so-it-can-be-concatenated-with-the-rest-of-the-data">
     Turn the labels array into a DataFrame so it can be concatenated with the rest of the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-component-analysis">
   9. Principal Component Analysis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-the-centroid-data-to-the-scaled-data">
     Add the centroid data to the scaled data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inspect-dataframe-which-pca-is-being-performed-on">
     Inspect dataframe which PCA is being performed on
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-pca-to-project-the-data-to-3-dimensions">
     Use PCA to project the data to 3 dimensions
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-how-much-variance-these-3-axes-explain">
     Look at how much variance these 3 axes explain
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#remove-the-centroid-data-from-this-table">
     Remove the centroid data from this table
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#add-these-principal-component-columns-and-the-cluster-labels-to-the-rest-of-the-data">
     Add these principal component columns and the cluster labels to the rest of the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-6-clusters-using-the-pca-axes">
   10. Plot the 6 clusters using the PCA axes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-clusters">
     Plot the clusters
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#choose-the-columns-to-plot">
       Choose the columns to plot
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#check-the-minimum-and-maximum-values-across-all-axes">
       Check the minimum and maximum values across all axes
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-function-to-visualise-3d-projection">
       Create function to visualise 3D projection
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-original-data">
       Plot the original data
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-data-colouring-the-different-clusters">
       Plot the data colouring the different clusters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-data-colouring-the-different-clusters-plotting-their-centroids">
       Plot the data colouring the different clusters &amp; plotting their centroids
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#plot-the-data-colouring-the-different-groups">
       Plot the data colouring the different groups
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyse-these-6-clusters">
   11. Analyse these 6 clusters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-see-how-the-old-and-young-fall-into-these-clusters">
     a.) See how the ‘old’ and ‘young’ fall into these clusters
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-characterising-the-clusters-based-on-their-different-cognitive-attributes">
     b.) Characterising the clusters based on their different
     <em>
      cognitive attributes
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-functions-to-help-analyse-parameters">
       Create functions to help analyse parameters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary-statistics-for-entire-subject-group">
       Summary statistics for entire subject group
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analsye-cluster-0">
       Analsye Cluster 0
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analsye-cluster-1">
       Analsye Cluster 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analsye-cluster-2">
       Analsye Cluster 2
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analsye-cluster-3">
       Analsye Cluster 3
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analsye-cluster-4">
       Analsye Cluster 4
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analsye-cluster-5">
       Analsye Cluster 5
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p>=============================================================</p>
<div class="section" id="setup">
<h1>1. Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="importing-relevant-libraries">
<h2>Importing Relevant Libraries<a class="headerlink" href="#importing-relevant-libraries" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general">
<h3>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-scaling-the-data">
<h3>For scaling the data<a class="headerlink" href="#for-scaling-the-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">normalize</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-clustering">
<h3>For clustering<a class="headerlink" href="#for-clustering" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">SpectralClustering</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">cdist</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-principal-component-analysis">
<h3>For principal component analysis<a class="headerlink" href="#for-principal-component-analysis" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="for-plotting">
<h3>For plotting<a class="headerlink" href="#for-plotting" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>=============================================================</p>
</div>
</div>
</div>
<div class="section" id="read-in-the-data">
<h1>2. Read in the data<a class="headerlink" href="#read-in-the-data" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="read-in-data-from-pvl-delta-model">
<h2>Read in data from PVL-Delta model<a class="headerlink" href="#read-in-data-from-pvl-delta-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/parameter_igt_pvl_delta.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="inspect-the-data">
<h3>Inspect the data<a class="headerlink" href="#inspect-the-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>SubID</th>
      <th>LR</th>
      <th>Outcome_Sens</th>
      <th>Response_cons</th>
      <th>Loss_Aver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>1</td>
      <td>0.159011</td>
      <td>0.487522</td>
      <td>0.686815</td>
      <td>0.954498</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>2</td>
      <td>0.064666</td>
      <td>0.511008</td>
      <td>1.391790</td>
      <td>0.295529</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>3</td>
      <td>0.113089</td>
      <td>0.465141</td>
      <td>0.918734</td>
      <td>0.533232</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>4</td>
      <td>0.089273</td>
      <td>0.500391</td>
      <td>0.703737</td>
      <td>0.869859</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>5</td>
      <td>0.233898</td>
      <td>0.488053</td>
      <td>0.897867</td>
      <td>0.511095</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_pvl_delta</span><span class="p">[</span><span class="s2">&quot;LR&quot;</span><span class="p">],</span> <span class="n">df_pvl_delta</span><span class="p">[</span><span class="s2">&quot;Outcome_Sens&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x239972f1910&gt;
</pre></div>
</div>
<img alt="_images/Clustering_17_1.png" src="_images/Clustering_17_1.png" />
</div>
</div>
</div>
<div class="section" id="processing">
<h3>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">¶</a></h3>
<p>‘SubID’ column can be dropped as it is not used for analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SubID&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_pvl_delta</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Outcome_Sens</th>
      <th>Response_cons</th>
      <th>Loss_Aver</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>0.159011</td>
      <td>0.487522</td>
      <td>0.686815</td>
      <td>0.954498</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>0.064666</td>
      <td>0.511008</td>
      <td>1.391790</td>
      <td>0.295529</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>0.113089</td>
      <td>0.465141</td>
      <td>0.918734</td>
      <td>0.533232</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>0.089273</td>
      <td>0.500391</td>
      <td>0.703737</td>
      <td>0.869859</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>0.233898</td>
      <td>0.488053</td>
      <td>0.897867</td>
      <td>0.511095</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="read-in-data-from-the-orl-model">
<h2>Read in data from the ORL model<a class="headerlink" href="#read-in-data-from-the-orl-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/parameter_igt_orl.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Inspect the data<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subjID</th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
      <th>A+-A-</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>old</td>
      <td>0.324444</td>
      <td>0.068862</td>
      <td>1.502130</td>
      <td>2.523191</td>
      <td>-5.547480</td>
      <td>0.255581</td>
    </tr>
    <tr>
      <th>1</th>
      <td>old</td>
      <td>0.885744</td>
      <td>0.120145</td>
      <td>0.012591</td>
      <td>3.193244</td>
      <td>-9.159800</td>
      <td>0.765598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>old</td>
      <td>0.318205</td>
      <td>0.078128</td>
      <td>1.927309</td>
      <td>0.615708</td>
      <td>9.272336</td>
      <td>0.240077</td>
    </tr>
    <tr>
      <th>3</th>
      <td>old</td>
      <td>0.728192</td>
      <td>0.106737</td>
      <td>0.388407</td>
      <td>2.595746</td>
      <td>-2.239555</td>
      <td>0.621455</td>
    </tr>
    <tr>
      <th>4</th>
      <td>old</td>
      <td>0.356229</td>
      <td>0.091987</td>
      <td>1.810674</td>
      <td>0.508605</td>
      <td>9.825699</td>
      <td>0.264241</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id2">
<h3>Processing<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>‘subjID’ column in input file is actually the ‘group’ column based on its contents. Thus, rename the column as so.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_orl</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;subjID&#39;</span><span class="p">:</span><span class="s1">&#39;group&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_orl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>A+</th>
      <th>A-</th>
      <th>K</th>
      <th>BetaF</th>
      <th>BetaP</th>
      <th>A+-A-</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>old</td>
      <td>0.324444</td>
      <td>0.068862</td>
      <td>1.502130</td>
      <td>2.523191</td>
      <td>-5.547480</td>
      <td>0.255581</td>
    </tr>
    <tr>
      <th>1</th>
      <td>old</td>
      <td>0.885744</td>
      <td>0.120145</td>
      <td>0.012591</td>
      <td>3.193244</td>
      <td>-9.159800</td>
      <td>0.765598</td>
    </tr>
    <tr>
      <th>2</th>
      <td>old</td>
      <td>0.318205</td>
      <td>0.078128</td>
      <td>1.927309</td>
      <td>0.615708</td>
      <td>9.272336</td>
      <td>0.240077</td>
    </tr>
    <tr>
      <th>3</th>
      <td>old</td>
      <td>0.728192</td>
      <td>0.106737</td>
      <td>0.388407</td>
      <td>2.595746</td>
      <td>-2.239555</td>
      <td>0.621455</td>
    </tr>
    <tr>
      <th>4</th>
      <td>old</td>
      <td>0.356229</td>
      <td>0.091987</td>
      <td>1.810674</td>
      <td>0.508605</td>
      <td>9.825699</td>
      <td>0.264241</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="read-in-data-from-the-vpp-model">
<h2>Read in data from the VPP model<a class="headerlink" href="#read-in-data-from-the-vpp-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/parameters_igt_vpp.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Inspect the data<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>SubID</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>1</td>
      <td>0.038441</td>
      <td>0.630402</td>
      <td>1.207295</td>
      <td>1.050323</td>
      <td>-0.535035</td>
      <td>-1.913099</td>
      <td>0.669323</td>
      <td>0.660446</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>2</td>
      <td>0.045673</td>
      <td>0.630331</td>
      <td>1.628191</td>
      <td>0.205205</td>
      <td>-0.133367</td>
      <td>-1.423580</td>
      <td>0.427207</td>
      <td>0.719352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>3</td>
      <td>0.045468</td>
      <td>0.602974</td>
      <td>1.395572</td>
      <td>0.383055</td>
      <td>-0.344822</td>
      <td>-1.719826</td>
      <td>0.493249</td>
      <td>0.688723</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>4</td>
      <td>0.035789</td>
      <td>0.635677</td>
      <td>1.067831</td>
      <td>0.823790</td>
      <td>-0.229192</td>
      <td>-1.484455</td>
      <td>0.625835</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>5</td>
      <td>0.060655</td>
      <td>0.636276</td>
      <td>1.802964</td>
      <td>0.329246</td>
      <td>-0.616020</td>
      <td>-2.561017</td>
      <td>0.439912</td>
      <td>0.655563</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="id4">
<h3>Processing<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>‘SubID’ column is dropped as before as it is not used for analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_vpp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SubID&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_vpp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>0.038441</td>
      <td>0.630402</td>
      <td>1.207295</td>
      <td>1.050323</td>
      <td>-0.535035</td>
      <td>-1.913099</td>
      <td>0.669323</td>
      <td>0.660446</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>0.045673</td>
      <td>0.630331</td>
      <td>1.628191</td>
      <td>0.205205</td>
      <td>-0.133367</td>
      <td>-1.423580</td>
      <td>0.427207</td>
      <td>0.719352</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>0.045468</td>
      <td>0.602974</td>
      <td>1.395572</td>
      <td>0.383055</td>
      <td>-0.344822</td>
      <td>-1.719826</td>
      <td>0.493249</td>
      <td>0.688723</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>0.035789</td>
      <td>0.635677</td>
      <td>1.067831</td>
      <td>0.823790</td>
      <td>-0.229192</td>
      <td>-1.484455</td>
      <td>0.625835</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>0.060655</td>
      <td>0.636276</td>
      <td>1.802964</td>
      <td>0.329246</td>
      <td>-0.616020</td>
      <td>-2.561017</td>
      <td>0.439912</td>
      <td>0.655563</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>=============================================================</p>
</div>
</div>
</div>
<div class="section" id="standardise-the-data">
<h1>3. Standardise the data<a class="headerlink" href="#standardise-the-data" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="choose-which-data-source-to-use">
<h2>Choose which data source to use<a class="headerlink" href="#choose-which-data-source-to-use" title="Permalink to this headline">¶</a></h2>
<p>In the paper, Lili concludes that the VPP model was the best-fitting model in terms of short-term prediction performance for the IGT task, as measured by one-step-ahead leave-one-out information criterion (LOOIC) [1]. Therefore, we will begin by analysing this dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chosen_df</span> <span class="o">=</span> <span class="n">df_vpp</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The <em>‘group’</em> column will not be used as a feature for the clustering analysis, so we will exclude this from the processing for now.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">chosen_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can describe the data in this DataFrame and look at the ranges of the variables and their distributions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.070824</td>
      <td>0.560575</td>
      <td>1.329323</td>
      <td>0.952138</td>
      <td>0.460940</td>
      <td>-0.720379</td>
      <td>0.406367</td>
      <td>0.622995</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.064683</td>
      <td>0.111139</td>
      <td>0.198041</td>
      <td>0.580621</td>
      <td>1.185591</td>
      <td>1.102656</td>
      <td>0.187483</td>
      <td>0.066657</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.027454</td>
      <td>0.352471</td>
      <td>0.879707</td>
      <td>0.193857</td>
      <td>-2.977630</td>
      <td>-2.912838</td>
      <td>0.042780</td>
      <td>0.452978</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.038294</td>
      <td>0.448811</td>
      <td>1.202790</td>
      <td>0.528927</td>
      <td>-0.287230</td>
      <td>-1.634716</td>
      <td>0.256420</td>
      <td>0.569390</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.050247</td>
      <td>0.590334</td>
      <td>1.316736</td>
      <td>0.760613</td>
      <td>0.593115</td>
      <td>-0.779120</td>
      <td>0.439912</td>
      <td>0.640917</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.078495</td>
      <td>0.646090</td>
      <td>1.428836</td>
      <td>1.292569</td>
      <td>1.419412</td>
      <td>0.137599</td>
      <td>0.565139</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.617431</td>
      <td>0.818137</td>
      <td>1.938694</td>
      <td>2.698527</td>
      <td>2.559126</td>
      <td>1.583109</td>
      <td>0.858421</td>
      <td>0.744017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="visualising-the-distributions-of-the-different-variables">
<h2>Visualising the distributions of the different variables<a class="headerlink" href="#visualising-the-distributions-of-the-different-variables" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x23997b40f70&gt;
</pre></div>
</div>
<img alt="_images/Clustering_42_1.png" src="_images/Clustering_42_1.png" />
</div>
</div>
<p>From the pair plot above, we can clearly see that many of the variables have either positively or negatively skewed distributions. There also appears to be many outliers in each distribution and the different parameters don’t share a common scale.</p>
<p>To remedy this and also to ensure sound clustering analysis, we are going to <strong>standardise</strong> the dataset.</p>
</div>
<div class="section" id="scaling-and-normalising-the-features">
<h2>Scaling and normalising the features<a class="headerlink" href="#scaling-and-normalising-the-features" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardising the data</span>
<span class="n">standardised_train_array</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1"># Normalizing the data</span>
<span class="n">normalised_nd_standardised_train_array</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">standardised_train_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Converting the scaled array back to a DataFrame</span>
<span class="n">scaled_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">normalised_nd_standardised_train_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">train_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaled_train_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.530000e+02</td>
      <td>1.530000e+02</td>
      <td>1.530000e+02</td>
      <td>1.530000e+02</td>
      <td>153.000000</td>
      <td>1.530000e+02</td>
      <td>1.530000e+02</td>
      <td>1.530000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-2.902544e-18</td>
      <td>1.161018e-17</td>
      <td>2.031781e-17</td>
      <td>1.451272e-18</td>
      <td>0.000000</td>
      <td>2.902544e-18</td>
      <td>-1.161018e-17</td>
      <td>-2.612289e-17</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.111071e-02</td>
      <td>8.111071e-02</td>
      <td>8.111071e-02</td>
      <td>8.111071e-02</td>
      <td>0.081111</td>
      <td>8.111071e-02</td>
      <td>8.111071e-02</td>
      <td>8.111071e-02</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-5.438584e-02</td>
      <td>-1.518770e-01</td>
      <td>-1.841472e-01</td>
      <td>-1.059293e-01</td>
      <td>-0.235245</td>
      <td>-1.612760e-01</td>
      <td>-1.572984e-01</td>
      <td>-2.068814e-01</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-4.079214e-02</td>
      <td>-8.156703e-02</td>
      <td>-5.182350e-02</td>
      <td>-5.912117e-02</td>
      <td>-0.051185</td>
      <td>-6.725810e-02</td>
      <td>-6.487139e-02</td>
      <td>-6.522806e-02</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-2.580297e-02</td>
      <td>2.171851e-02</td>
      <td>-5.155164e-03</td>
      <td>-2.675543e-02</td>
      <td>0.009043</td>
      <td>-4.320979e-03</td>
      <td>1.451265e-02</td>
      <td>2.180811e-02</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9.618559e-03</td>
      <td>6.240928e-02</td>
      <td>4.075695e-02</td>
      <td>4.755704e-02</td>
      <td>0.065573</td>
      <td>6.311234e-02</td>
      <td>6.868974e-02</td>
      <td>6.446273e-02</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.854293e-01</td>
      <td>1.879718e-01</td>
      <td>2.495777e-01</td>
      <td>2.439647e-01</td>
      <td>0.143545</td>
      <td>1.694432e-01</td>
      <td>1.955719e-01</td>
      <td>1.472632e-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="add-the-group-feature-back-in">
<h2>Add the group feature back in<a class="headerlink" href="#add-the-group-feature-back-in" title="Permalink to this headline">¶</a></h2>
<p>Since the data is now fully processed and ready for clustering, we can add the <em>‘group’</em> column back in as it will be needed later on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaled_full_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">chosen_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">],</span> <span class="n">scaled_train_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaled_full_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>-0.040608</td>
      <td>0.050960</td>
      <td>-0.049978</td>
      <td>0.013716</td>
      <td>-0.068138</td>
      <td>-0.087736</td>
      <td>0.113763</td>
      <td>0.045572</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>-0.031540</td>
      <td>0.050908</td>
      <td>0.122406</td>
      <td>-0.104344</td>
      <td>-0.040659</td>
      <td>-0.051727</td>
      <td>0.009016</td>
      <td>0.117250</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>-0.031797</td>
      <td>0.030943</td>
      <td>0.027133</td>
      <td>-0.079499</td>
      <td>-0.055125</td>
      <td>-0.073519</td>
      <td>0.037588</td>
      <td>0.079980</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>-0.043933</td>
      <td>0.054810</td>
      <td>-0.107098</td>
      <td>-0.017930</td>
      <td>-0.047214</td>
      <td>-0.056205</td>
      <td>0.094949</td>
      <td>0.064463</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>-0.012752</td>
      <td>0.055247</td>
      <td>0.193987</td>
      <td>-0.087016</td>
      <td>-0.073679</td>
      <td>-0.135396</td>
      <td>0.014513</td>
      <td>0.039631</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>=============================================================</p>
</div>
</div>
<div class="section" id="consideration-of-clustering-algorithms-and-optimal-number-of-clusters">
<h1>4. Consideration of clustering algorithms and optimal number of clusters<a class="headerlink" href="#consideration-of-clustering-algorithms-and-optimal-number-of-clusters" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<p>There are a number of clustering algorithms which we could implement. Below, we try the <em>KMeans</em> and <em>Spectral Clustering</em> algorithms and analyse how these perform on the data in question.</p>
<p>To determine which algorithm is more appropriate to the dataset, we will measure their performance using the <em>Silhouette Coefficient</em>. The Silhouette Coefficient of a data point quantifies how similar a data point is to its own cluster compared to other clusters. We will use the mean Silhouette Coefficient across all data points to compare the performace of algorithms.</p>
<p>The <strong>Silhouette Coefficient</strong> for a particular data point is calculated by the below formula:</p>
<div class="math notranslate nohighlight">
\[s = \frac{b - a}{max(a, b)}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><strong>a</strong> is the mean distance between a data point and all other points in the same cluster. (the mean intra-cluster distance)</p></li>
<li><p><strong>b</strong> is the mean distance between a data point and all other points in the <em>next nearest cluster</em>. (the mean nearest-cluster distance)</p></li>
</ul>
<p>The Silhouette score can assume values between -1 and 1. Scores closer to -1 indicate incorrect clustering whereas those nearer to +1 indicate highly dense clustering. Scores around zero are indicative of overlapping clusters. Therefore, a good indicator of what clustering algorithm to choose would be the one whose mean Silhouette Coefficient is nearest to 1 [5].</p>
<div class="section" id="choose-the-number-of-clusters-to-test-these-algorithms-on">
<h2>Choose the number of clusters to test these algorithms on<a class="headerlink" href="#choose-the-number-of-clusters-to-test-these-algorithms-on" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_clusters_to_iter</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="choose-the-random-seed-number-for-reproducibility">
<h2>Choose the random seed number for reproducibility<a class="headerlink" href="#choose-the-random-seed-number-for-reproducibility" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_seed_val</span> <span class="o">=</span> <span class="mi">127</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="define-the-functions-for-calculating-the-silhouette-scores-of-the-different-models">
<h2>Define the functions for calculating the silhouette scores of the different models<a class="headerlink" href="#define-the-functions-for-calculating-the-silhouette-scores-of-the-different-models" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_silhouette_scores_list</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">model_function</span><span class="p">,</span> <span class="n">num_clusters_to_itr</span><span class="p">,</span> <span class="n">random_seed_val</span><span class="p">,</span> <span class="n">affinity_value</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="c1"># Initialise empty list for the Silhouette Scores for KMeans model</span>
    <span class="n">s_scores</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Running algorithm and calculating Silhouette Score</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">num_clusters_to_iter</span><span class="p">:</span>

        <span class="c1"># Building the clustering model</span>
        <span class="k">if</span> <span class="n">affinity_value</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">model_function</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">random_seed_val</span><span class="p">,</span> <span class="n">affinity</span> <span class="o">=</span> <span class="n">affinity_value</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">model_function</span><span class="p">(</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="n">random_seed_val</span><span class="p">)</span>
        
        <span class="c1"># Training the model and storing the predicted cluster labels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">)</span>

        <span class="c1"># Evaluating the performance and adding score to list</span>
        <span class="n">s_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">silhouette_score</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">labels</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">s_scores</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analyse_silhouette_scores_to_get_optimal_cluster_number</span><span class="p">(</span><span class="n">silhouette_score_list</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">):</span>
    
    <span class="c1"># Analyse these results to see the optimal cluster number</span>
    <span class="n">max_silhouette_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">silhouette_score_list</span><span class="p">)</span>
    <span class="n">index_max_score</span> <span class="o">=</span> <span class="n">silhouette_score_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">max_silhouette_score</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The maximum Silhouette Score was&quot;</span><span class="p">,</span> <span class="n">max_silhouette_score</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This score is achieved by running&quot;</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">[</span><span class="n">index_max_score</span><span class="p">],</span> <span class="s2">&quot;clusters&quot;</span><span class="p">)</span>

    <span class="c1"># plot the silhoutte scores against the cluster numbers</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">silhouette_score_list</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Silhouette Score&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Silhouette scores for the model accross a different number of clusters&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Output a table of the score for each cluster</span>
    <span class="n">cluster_nd_score_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">silhouette_score_list</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">num_clusters_to_iter</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Silhouette Score&quot;</span><span class="p">})</span>
    <span class="n">cluster_nd_score_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;# Clusters&quot;</span>
    
    <span class="k">return</span> <span class="n">cluster_nd_score_df</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="silhouette-scores-for-the-kmeans-algorithm">
<h2>Silhouette Scores for the KMeans Algorithm<a class="headerlink" href="#silhouette-scores-for-the-kmeans-algorithm" title="Permalink to this headline">¶</a></h2>
<p>Below the KMeans algorithm is executed with various different numbers of clusters (from 2 clusters to 10). The mean Silhouette Coefficient (or more simply, the <em>Silhouette Score</em>) for the clusters produced is calculated for each execution of the algorithm. These scores are plotted below.</p>
<div class="section" id="use-k-means-to-calculate-the-silhouette-score-for-2-10-clusters">
<h3>Use K-Means to calculate the Silhouette Score for 2-10 clusters<a class="headerlink" href="#use-k-means-to-calculate-the-silhouette-score-for-2-10-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_scores_km</span> <span class="o">=</span> <span class="n">get_silhouette_scores_list</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">KMeans</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">random_seed_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analyse-these-scores-and-output-plot-the-score">
<h3>Analyse these scores and output &amp; plot the score<a class="headerlink" href="#analyse-these-scores-and-output-plot-the-score" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_nd_score_km_df</span> <span class="o">=</span> <span class="n">analyse_silhouette_scores_to_get_optimal_cluster_number</span><span class="p">(</span><span class="n">s_scores_km</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">)</span>
<span class="n">cluster_nd_score_km_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum Silhouette Score was 0.29512958858192134
This score is achieved by running 2 clusters
</pre></div>
</div>
<img alt="_images/Clustering_66_1.png" src="_images/Clustering_66_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th># Clusters</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Silhouette Score</th>
      <td>0.29513</td>
      <td>0.251348</td>
      <td>0.251219</td>
      <td>0.2563</td>
      <td>0.268886</td>
      <td>0.25616</td>
      <td>0.247031</td>
      <td>0.236969</td>
      <td>0.239581</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="silhouette-scores-for-the-spectral-clustering-algorithm">
<h2>Silhouette Scores for the Spectral Clustering Algorithm<a class="headerlink" href="#silhouette-scores-for-the-spectral-clustering-algorithm" title="Permalink to this headline">¶</a></h2>
<p>In order to explore more options for clustering, we are going to test the performance of two different implementations of the Spectral Clustering algorithm. One implementation constructs the <em>affinity matrix</em> using a radial basis function (RBF) kernel (aka Gaussian kernel) while the other constructs this matrix by computing a graph of nearest neighbors.</p>
<div class="section" id="spectral-clustering-with-affinity-rbf">
<h3>Spectral Clustering with <em>affinity=’rbf’</em><a class="headerlink" href="#spectral-clustering-with-affinity-rbf" title="Permalink to this headline">¶</a></h3>
<div class="section" id="use-spectral-clustering-to-calculate-the-silhouette-score-for-2-10-clusters">
<h4>Use Spectral Clustering to calculate the Silhouette Score for 2-10 clusters<a class="headerlink" href="#use-spectral-clustering-to-calculate-the-silhouette-score-for-2-10-clusters" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_scores_rbf</span> <span class="o">=</span> <span class="n">get_silhouette_scores_list</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">SpectralClustering</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">random_seed_val</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id5">
<h4>Analyse these scores and output &amp; plot the score<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_nd_score_rbf_df</span> <span class="o">=</span> <span class="n">analyse_silhouette_scores_to_get_optimal_cluster_number</span><span class="p">(</span><span class="n">s_scores_rbf</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">)</span>
<span class="n">cluster_nd_score_rbf_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum Silhouette Score was 0.29512958858192134
This score is achieved by running 2 clusters
</pre></div>
</div>
<img alt="_images/Clustering_73_1.png" src="_images/Clustering_73_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th># Clusters</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Silhouette Score</th>
      <td>0.29513</td>
      <td>0.252844</td>
      <td>0.25059</td>
      <td>0.267099</td>
      <td>0.237073</td>
      <td>0.201738</td>
      <td>0.146303</td>
      <td>0.096382</td>
      <td>0.179345</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="spectral-clustering-with-affinity-nearest-neighbors">
<h3>Spectral Clustering with <em>affinity=’nearest_neighbors’</em><a class="headerlink" href="#spectral-clustering-with-affinity-nearest-neighbors" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id6">
<h4>Use Spectral Clustering to calculate the Silhouette Score for 2-10 clusters<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_scores_nn</span> <span class="o">=</span> <span class="n">get_silhouette_scores_list</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">SpectralClustering</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">random_seed_val</span><span class="p">,</span> <span class="s1">&#39;nearest_neighbors&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id7">
<h4>Analyse these scores and output &amp; plot the score<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_nd_score_nn_df</span> <span class="o">=</span> <span class="n">analyse_silhouette_scores_to_get_optimal_cluster_number</span><span class="p">(</span><span class="n">s_scores_nn</span><span class="p">,</span> <span class="n">num_clusters_to_iter</span><span class="p">)</span>
<span class="n">cluster_nd_score_nn_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum Silhouette Score was 0.29512958858192134
This score is achieved by running 2 clusters
</pre></div>
</div>
<img alt="_images/Clustering_78_1.png" src="_images/Clustering_78_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th># Clusters</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Silhouette Score</th>
      <td>0.29513</td>
      <td>0.255765</td>
      <td>0.243764</td>
      <td>0.246033</td>
      <td>0.234108</td>
      <td>0.237116</td>
      <td>0.216459</td>
      <td>0.201482</td>
      <td>0.191615</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see from the above results, running these clustering algorithms on this data using <strong>two clusters</strong> produces the best Silhouette Scores for all three algorithms.</p>
<p>One reason that we can see why this might be the case is that the sample of data subjects can be segmented into two groups as we saw at the start; <em>‘young’</em> and <em>‘old’</em> and these two clusters could just be encapsulating these two groups.
To test this, we will attempt to visualise these clusters.</p>
<p>From the above ouputs, we can see that all three algorithms get the same Silhouette Score for two clusters. As a result, we could choose any of the algorithms to test our hypothesis.</p>
<p>As the Spectral Clustering algorithm is more robust than KMeans, we will test this first, constructuing the affinity matrix using a radial basis function kernel (<em>affinity=’rbf’</em>).</p>
</div>
<div class="section" id="choose-the-number-of-clusters-to-use">
<h4>Choose the number of clusters to use<a class="headerlink" href="#choose-the-number-of-clusters-to-use" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_clusters</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>=============================================================</p>
</div>
</div>
</div>
</div>
<div class="section" id="cluster-the-data-using-2-clusters">
<h1>5. Cluster the data using 2 clusters<a class="headerlink" href="#cluster-the-data-using-2-clusters" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="build-the-rbf-spectral-clustering-model-with-these-2-clusters">
<h2>Build the ‘rbf’ spectral clustering model with these 2 clusters<a class="headerlink" href="#build-the-rbf-spectral-clustering-model-with-these-2-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spectral_model</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">affinity</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="training-the-model-and-storing-predicted-cluster-labels">
<h2>Training the model and storing predicted cluster labels<a class="headerlink" href="#training-the-model-and-storing-predicted-cluster-labels" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_labels_array</span> <span class="o">=</span> <span class="n">spectral_model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="turn-this-array-to-a-dataframe-so-it-can-be-concatenated-with-the-rest-of-the-data">
<h2>Turn this array to a dataframe so it can be concatenated with the rest of the data<a class="headerlink" href="#turn-this-array-to-a-dataframe-so-it-can-be-concatenated-with-the-rest-of-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_labels_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cluster_labels_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_labels_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="add-a-new-column-to-the-original-data-with-the-cluster-each-data-point-is-in">
<h2>Add a new column to the original data with the cluster each data point is in<a class="headerlink" href="#add-a-new-column-to-the-original-data-with-the-cluster-each-data-point-is-in" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_df_nd_cluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">chosen_df</span><span class="p">,</span> <span class="n">cluster_labels_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_df_nd_cluster</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>0.038441</td>
      <td>0.630402</td>
      <td>1.207295</td>
      <td>1.050323</td>
      <td>-0.535035</td>
      <td>-1.913099</td>
      <td>0.669323</td>
      <td>0.660446</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>0.045673</td>
      <td>0.630331</td>
      <td>1.628191</td>
      <td>0.205205</td>
      <td>-0.133367</td>
      <td>-1.423580</td>
      <td>0.427207</td>
      <td>0.719352</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>0.045468</td>
      <td>0.602974</td>
      <td>1.395572</td>
      <td>0.383055</td>
      <td>-0.344822</td>
      <td>-1.719826</td>
      <td>0.493249</td>
      <td>0.688723</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>0.035789</td>
      <td>0.635677</td>
      <td>1.067831</td>
      <td>0.823790</td>
      <td>-0.229192</td>
      <td>-1.484455</td>
      <td>0.625835</td>
      <td>0.675971</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>0.060655</td>
      <td>0.636276</td>
      <td>1.802964</td>
      <td>0.329246</td>
      <td>-0.616020</td>
      <td>-2.561017</td>
      <td>0.439912</td>
      <td>0.655563</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now that we have clustered this data based on the parameters, we want to verify our hypothesis that these 2 clusters will just contain the ‘young’ and ‘old’ groups exclusively.</p>
<p>We want to analyse these clusters to see how the ‘old’ and ‘young’ fall into these clusters and test this.</p>
<p>=============================================================</p>
</div>
</div>
<div class="section" id="analyse-these-2-clusters">
<h1>6. Analyse these 2 clusters<a class="headerlink" href="#analyse-these-2-clusters" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="create-function-to-see-how-the-young-and-old-people-are-distributed-within-each-cluster">
<h2>Create function to see how the young and old people are distributed within each cluster<a class="headerlink" href="#create-function-to-see-how-the-young-and-old-people-are-distributed-within-each-cluster" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">see_how_the_young_and_old_fall_into_the_clusters</span><span class="p">(</span><span class="n">input_df</span><span class="p">):</span>
    
    <span class="c1"># copy the dataframe so that we arent overwriting the input dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">input_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Create a dataframe showing how many people fell into each cluster</span>
    <span class="n">all_cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Cluster&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;All&quot;</span><span class="p">})</span>
    
    <span class="c1"># Change &#39;young&#39; to 1 and &#39;old&#39; to np.nan in the group column</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># Create a dataframe showing how many young people fell into each cluster</span>
    <span class="n">young_cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;Cluster&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Cluster&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">())</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;Young&quot;</span><span class="p">})</span>
    
    <span class="c1"># Create a dataframe showing how many old people fell into each cluster</span>
    <span class="n">old_cluster_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Cluster&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;Old&quot;</span><span class="p">})</span>
    
    <span class="c1"># Output how many &#39;young&#39; and &#39;old&#39; people fell into each cluster</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">all_cluster_df</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">young_cluster_df</span><span class="p">,</span> <span class="n">old_cluster_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Cluster&quot;</span><span class="p">),</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Cluster&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-the-distribution-of-young-and-old-people-among-the-2-clusters">
<h2>Check the distribution of young and old people among the 2 clusters<a class="headerlink" href="#check-the-distribution-of-young-and-old-people-among-the-2-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">see_how_the_young_and_old_fall_into_the_clusters</span><span class="p">(</span><span class="n">full_df_nd_cluster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All</th>
      <th>Young</th>
      <th>Old</th>
    </tr>
    <tr>
      <th>Cluster</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>90</td>
      <td>90</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63</td>
      <td>0</td>
      <td>63</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As you can see from the above table, our hypothesis was correct and the algorithm clustered the individuals into their respective age groups of ‘young’ and ‘old’.</p>
<p>While this test did not provide us with any more information than we already had, we felt it was vital to not make any assumptions and verify the results we expected to see.
So, even though from our analysis using the <em>Silhouette Score</em> we identified that two clusters maximised this score; this is because of how distinct the two groups of subjects are when it comes to decision-making and does not provide us with much insight. As a result, we are going to experiment with a different number of clusters and see if we can segement the subject group based on the different cognitive processes underlying the decision choices.</p>
<p>=============================================================</p>
</div>
</div>
<div class="section" id="re-consider-the-clustering-algorithms-and-the-number-of-clusters">
<h1>7. Re-consider the clustering algorithms and the number of clusters<a class="headerlink" href="#re-consider-the-clustering-algorithms-and-the-number-of-clusters" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<p>So we have experimented using two clusters and have decided that this does not provide us with enough aditional information to satisfy our analysis.</p>
<div class="section" id="create-function-to-output-the-silhoette-scores-excluding-two-clusters">
<h2>Create function to output the silhoette scores excluding two clusters<a class="headerlink" href="#create-function-to-output-the-silhoette-scores-excluding-two-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">take_in_a_dataframe_of_an_algorithms_silhouette_scores_and_output_analysis_excluding_cluster_2</span><span class="p">(</span><span class="n">cluster_nd_score_df</span><span class="p">):</span>
    
    <span class="c1"># remove cluster 2 from this dataframe</span>
    <span class="n">cluster_nd_score_df_no_2</span> <span class="o">=</span> <span class="n">cluster_nd_score_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># get the silhouette scores and cluster number</span>
    <span class="n">s_scores_without_2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_nd_score_df_no_2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">num_clusters_to_iter_without_2</span> <span class="o">=</span> <span class="n">cluster_nd_score_df_no_2</span><span class="o">.</span><span class="n">columns</span>

    <span class="c1"># analyse these scores</span>
    <span class="k">return</span> <span class="n">analyse_silhouette_scores_to_get_optimal_cluster_number</span><span class="p">(</span><span class="n">s_scores_without_2</span><span class="p">,</span> <span class="n">num_clusters_to_iter_without_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="silhouette-scores-for-the-kmeans-algorithm-excluding-two-clusters">
<h2>Silhouette Scores for the KMeans Algorithm (excluding two clusters)<a class="headerlink" href="#silhouette-scores-for-the-kmeans-algorithm-excluding-two-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">take_in_a_dataframe_of_an_algorithms_silhouette_scores_and_output_analysis_excluding_cluster_2</span><span class="p">(</span><span class="n">cluster_nd_score_km_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum Silhouette Score was 0.26888600929104295
This score is achieved by running 6 clusters
</pre></div>
</div>
<img alt="_images/Clustering_106_1.png" src="_images/Clustering_106_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th># Clusters</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Silhouette Score</th>
      <td>0.251348</td>
      <td>0.251219</td>
      <td>0.2563</td>
      <td>0.268886</td>
      <td>0.25616</td>
      <td>0.247031</td>
      <td>0.236969</td>
      <td>0.239581</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="silhouette-scores-for-spectral-clustering-algorithm-excluding-two-clusters">
<h2>Silhouette Scores for Spectral Clustering Algorithm (excluding two clusters)<a class="headerlink" href="#silhouette-scores-for-spectral-clustering-algorithm-excluding-two-clusters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spectral-clustering-with-affinity-rbf-excluding-two-clusters">
<h3>Spectral Clustering with <em>affinity=’rbf’</em> (excluding two clusters)<a class="headerlink" href="#spectral-clustering-with-affinity-rbf-excluding-two-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">take_in_a_dataframe_of_an_algorithms_silhouette_scores_and_output_analysis_excluding_cluster_2</span><span class="p">(</span><span class="n">cluster_nd_score_rbf_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum Silhouette Score was 0.26709917646414355
This score is achieved by running 5 clusters
</pre></div>
</div>
<img alt="_images/Clustering_109_1.png" src="_images/Clustering_109_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th># Clusters</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Silhouette Score</th>
      <td>0.252844</td>
      <td>0.25059</td>
      <td>0.267099</td>
      <td>0.237073</td>
      <td>0.201738</td>
      <td>0.146303</td>
      <td>0.096382</td>
      <td>0.179345</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="spectral-clustering-with-affinity-nearest-neighbors-excluding-two-clusters">
<h3>Spectral Clustering with <em>affinity=’nearest_neighbors’</em> (excluding two clusters)<a class="headerlink" href="#spectral-clustering-with-affinity-nearest-neighbors-excluding-two-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">take_in_a_dataframe_of_an_algorithms_silhouette_scores_and_output_analysis_excluding_cluster_2</span><span class="p">(</span><span class="n">cluster_nd_score_nn_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The maximum Silhouette Score was 0.2557650030222927
This score is achieved by running 3 clusters
</pre></div>
</div>
<img alt="_images/Clustering_111_1.png" src="_images/Clustering_111_1.png" />
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th># Clusters</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Silhouette Score</th>
      <td>0.255765</td>
      <td>0.243764</td>
      <td>0.246033</td>
      <td>0.234108</td>
      <td>0.237116</td>
      <td>0.216459</td>
      <td>0.201482</td>
      <td>0.191615</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Based on these results, it is clear that the next maximum Silhouette Score comes from the KMeans algorithm as when we exclude two clusters from this analysis, using six clusters produces the next maximum silhouette score of nearly 0.27.</p>
<p>As a result of this, we propose to analyse the data using the KMeans algorithm with 6 clusters to see how the subjects fall into these clusters.</p>
<p>When we used 2 clusters last time, we didn’t get much added information as the subjects ended up just being clustered into their respective age groups. Whereas when we use 6, we expect there to be sub-clusters within these different groups that will serve to detect more specific groups of people who have more dissimilar ways of making decisions.</p>
</div>
</div>
<div class="section" id="further-verification-of-optimal-number-of-clusters-using-elbow-curve-of-distortions">
<h2>Further verification of optimal number of clusters using elbow curve of distortions<a class="headerlink" href="#further-verification-of-optimal-number-of-clusters-using-elbow-curve-of-distortions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="calculate-distortion-scores-for-different-numbers-of-clusters">
<h3>Calculate distortion scores for different numbers of clusters<a class="headerlink" href="#calculate-distortion-scores-for-different-numbers-of-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distortions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">num_clusters_to_iter</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">num_clusters_to_iter</span><span class="p">:</span>
    <span class="n">kmeanModel</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">)</span>
    <span class="n">distortions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">cdist</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">kmeanModel</span><span class="o">.</span><span class="n">cluster_centers_</span><span class="p">,</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">scaled_train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-elbow-curve-of-the-distortion-that-each-cluster-gives">
<h3>Plot the elbow curve of the distortion that each cluster gives<a class="headerlink" href="#plot-the-elbow-curve-of-the-distortion-that-each-cluster-gives" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">num_clusters_to_iter</span><span class="p">,</span> <span class="n">distortions</span><span class="p">,</span> <span class="s1">&#39;bx-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;# Clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distortion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;The Elbow Method displaying the optimal number of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_117_0.png" src="_images/Clustering_117_0.png" />
</div>
</div>
<p>As we can see above, the rate of decrease in distortion begins to diminish once it passes 6 clusters. This concurs our choice of six as the optimal number of clusters.</p>
</div>
<div class="section" id="re-choose-the-number-of-clusters">
<h3>Re-choose the number of clusters<a class="headerlink" href="#re-choose-the-number-of-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_cluster_second_time</span> <span class="o">=</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
</div>
<p>=============================================================</p>
</div>
</div>
</div>
<div class="section" id="re-cluster-the-data-using-6-clusters">
<h1>8. Re-cluster the data using 6 clusters<a class="headerlink" href="#re-cluster-the-data-using-6-clusters" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="building-the-kmeans-model-and-clustering-the-data">
<h2>Building the KMeans model and clustering the data<a class="headerlink" href="#building-the-kmeans-model-and-clustering-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans_model</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_cluster_second_time</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id8">
<h2>Training the model and storing predicted cluster labels<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_cluster_labels_array</span> <span class="o">=</span> <span class="n">kmeans_model</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">scaled_train_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-the-centroids-of-these-clusters">
<h2>Get the centroids of these clusters<a class="headerlink" href="#get-the-centroids-of-these-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centroids</span> <span class="o">=</span> <span class="n">kmeans_model</span><span class="o">.</span><span class="n">cluster_centers_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centroids_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">centroids</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">scaled_train_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">centroids_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.032471</td>
      <td>0.042616</td>
      <td>0.059983</td>
      <td>-0.019006</td>
      <td>-0.078764</td>
      <td>-0.077391</td>
      <td>0.061948</td>
      <td>0.047959</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.034214</td>
      <td>-0.079584</td>
      <td>-0.008504</td>
      <td>-0.014698</td>
      <td>0.079838</td>
      <td>0.085922</td>
      <td>-0.115248</td>
      <td>-0.092626</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.042221</td>
      <td>0.063690</td>
      <td>-0.086186</td>
      <td>-0.013595</td>
      <td>0.019997</td>
      <td>0.021461</td>
      <td>0.036838</td>
      <td>0.051116</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.515193</td>
      <td>-0.110436</td>
      <td>0.105472</td>
      <td>-0.082967</td>
      <td>-0.048957</td>
      <td>-0.074280</td>
      <td>-0.108182</td>
      <td>-0.002396</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.012184</td>
      <td>0.082587</td>
      <td>0.013473</td>
      <td>0.162162</td>
      <td>0.048976</td>
      <td>0.037592</td>
      <td>0.042073</td>
      <td>0.064674</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.029271</td>
      <td>-0.094839</td>
      <td>0.035598</td>
      <td>-0.044714</td>
      <td>-0.047915</td>
      <td>-0.048742</td>
      <td>-0.017808</td>
      <td>-0.066402</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="turn-the-labels-array-into-a-dataframe-so-it-can-be-concatenated-with-the-rest-of-the-data">
<h2>Turn the labels array into a DataFrame so it can be concatenated with the rest of the data<a class="headerlink" href="#turn-the-labels-array-into-a-dataframe-so-it-can-be-concatenated-with-the-rest-of-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_cluster_labels_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">second_cluster_labels_array</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">second_cluster_labels_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In order to visualise these clusters, we will need to reduce the dimensionality of the original Dataframe so that we can represent each data point in a two dimensional space. This can be achieved by performing <strong>Principal Component Analysis</strong> on the data. This is done below.</p>
<p>=============================================================</p>
</div>
</div>
<div class="section" id="principal-component-analysis">
<h1>9. Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<p>There are eight parameters in this model so principal component analysis is performed below to encapsulate this information into <strong>three principal component axes</strong>.</p>
<div class="section" id="add-the-centroid-data-to-the-scaled-data">
<h2>Add the centroid data to the scaled data<a class="headerlink" href="#add-the-centroid-data-to-the-scaled-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">individuals_nd_centroids_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">scaled_train_df</span><span class="p">,</span> <span class="n">centroids_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="inspect-dataframe-which-pca-is-being-performed-on">
<h2>Inspect dataframe which PCA is being performed on<a class="headerlink" href="#inspect-dataframe-which-pca-is-being-performed-on" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">individuals_nd_centroids_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.040608</td>
      <td>0.050960</td>
      <td>-0.049978</td>
      <td>0.013716</td>
      <td>-0.068138</td>
      <td>-0.087736</td>
      <td>0.113763</td>
      <td>0.045572</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.031540</td>
      <td>0.050908</td>
      <td>0.122406</td>
      <td>-0.104344</td>
      <td>-0.040659</td>
      <td>-0.051727</td>
      <td>0.009016</td>
      <td>0.117250</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.031797</td>
      <td>0.030943</td>
      <td>0.027133</td>
      <td>-0.079499</td>
      <td>-0.055125</td>
      <td>-0.073519</td>
      <td>0.037588</td>
      <td>0.079980</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.043933</td>
      <td>0.054810</td>
      <td>-0.107098</td>
      <td>-0.017930</td>
      <td>-0.047214</td>
      <td>-0.056205</td>
      <td>0.094949</td>
      <td>0.064463</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.012752</td>
      <td>0.055247</td>
      <td>0.193987</td>
      <td>-0.087016</td>
      <td>-0.073679</td>
      <td>-0.135396</td>
      <td>0.014513</td>
      <td>0.039631</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="use-pca-to-project-the-data-to-3-dimensions">
<h2>Use PCA to project the data to 3 dimensions<a class="headerlink" href="#use-pca-to-project-the-data-to-3-dimensions" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the number of components</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># create an array transforming the daa into these 3 components</span>
<span class="n">principal_components_array</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">individuals_nd_centroids_df</span><span class="p">)</span>

<span class="c1"># turn this array to a dataframe</span>
<span class="n">principal_components_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">principal_components_array</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">,</span> <span class="s1">&#39;PC2&#39;</span><span class="p">,</span> <span class="s1">&#39;PC3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">principal_components_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.156070</td>
      <td>0.069499</td>
      <td>-0.029578</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.076813</td>
      <td>0.118766</td>
      <td>0.000360</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.086327</td>
      <td>0.103496</td>
      <td>-0.041220</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.150284</td>
      <td>0.021520</td>
      <td>-0.074752</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.052569</td>
      <td>0.213872</td>
      <td>0.040760</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="look-at-how-much-variance-these-3-axes-explain">
<h2>Look at how much variance these 3 axes explain<a class="headerlink" href="#look-at-how-much-variance-these-3-axes-explain" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">When projecting the data onto the three principal componets, approximately </span><span class="si">{}% o</span><span class="s2">f the variance in the original data is retained&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.35168356 0.24934943 0.13503315]

When projecting the data onto the three principal componets, approximately 73.6% of the variance in the original data is retained
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="remove-the-centroid-data-from-this-table">
<h2>Remove the centroid data from this table<a class="headerlink" href="#remove-the-centroid-data-from-this-table" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">individual_pca_df</span> <span class="o">=</span> <span class="n">principal_components_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="p">:]</span>

<span class="n">pca_centroid_df</span> <span class="o">=</span> <span class="n">principal_components_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-these-principal-component-columns-and-the-cluster-labels-to-the-rest-of-the-data">
<h2>Add these principal component columns and the cluster labels to the rest of the data<a class="headerlink" href="#add-these-principal-component-columns-and-the-cluster-labels-to-the-rest-of-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_full_scaled_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">scaled_full_df</span><span class="p">,</span> <span class="n">individual_pca_df</span><span class="p">,</span> <span class="n">second_cluster_labels_df</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_full_scaled_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
      <th>PC1</th>
      <th>PC2</th>
      <th>PC3</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>-0.040608</td>
      <td>0.050960</td>
      <td>-0.049978</td>
      <td>0.013716</td>
      <td>-0.068138</td>
      <td>-0.087736</td>
      <td>0.113763</td>
      <td>0.045572</td>
      <td>-0.156070</td>
      <td>0.069499</td>
      <td>-0.029578</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>-0.031540</td>
      <td>0.050908</td>
      <td>0.122406</td>
      <td>-0.104344</td>
      <td>-0.040659</td>
      <td>-0.051727</td>
      <td>0.009016</td>
      <td>0.117250</td>
      <td>-0.076813</td>
      <td>0.118766</td>
      <td>0.000360</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>-0.031797</td>
      <td>0.030943</td>
      <td>0.027133</td>
      <td>-0.079499</td>
      <td>-0.055125</td>
      <td>-0.073519</td>
      <td>0.037588</td>
      <td>0.079980</td>
      <td>-0.086327</td>
      <td>0.103496</td>
      <td>-0.041220</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>-0.043933</td>
      <td>0.054810</td>
      <td>-0.107098</td>
      <td>-0.017930</td>
      <td>-0.047214</td>
      <td>-0.056205</td>
      <td>0.094949</td>
      <td>0.064463</td>
      <td>-0.150284</td>
      <td>0.021520</td>
      <td>-0.074752</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>-0.012752</td>
      <td>0.055247</td>
      <td>0.193987</td>
      <td>-0.087016</td>
      <td>-0.073679</td>
      <td>-0.135396</td>
      <td>0.014513</td>
      <td>0.039631</td>
      <td>-0.052569</td>
      <td>0.213872</td>
      <td>0.040760</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>=============================================================</p>
</div>
</div>
<div class="section" id="plot-the-6-clusters-using-the-pca-axes">
<h1>10. Plot the 6 clusters using the PCA axes<a class="headerlink" href="#plot-the-6-clusters-using-the-pca-axes" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="plot-the-clusters">
<h2>Plot the clusters<a class="headerlink" href="#plot-the-clusters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="choose-the-columns-to-plot">
<h3>Choose the columns to plot<a class="headerlink" href="#choose-the-columns-to-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span> <span class="o">=</span> <span class="n">final_full_scaled_df</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">]</span>
<span class="n">pc2</span> <span class="o">=</span> <span class="n">final_full_scaled_df</span><span class="p">[</span><span class="s1">&#39;PC2&#39;</span><span class="p">]</span>
<span class="n">pc3</span> <span class="o">=</span> <span class="n">final_full_scaled_df</span><span class="p">[</span><span class="s1">&#39;PC3&#39;</span><span class="p">]</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">final_full_scaled_df</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span>
<span class="n">cluster</span> <span class="o">=</span> <span class="n">final_full_scaled_df</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span>
<span class="n">all_rows</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;All&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">final_full_scaled_df</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-the-minimum-and-maximum-values-across-all-axes">
<h3>Check the minimum and maximum values across all axes<a class="headerlink" href="#check-the-minimum-and-maximum-values-across-all-axes" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pc1&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">pc1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">pc1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pc2&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">pc2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">pc2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pc3&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">pc3</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">pc3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>pc1 -0.23165377890198954 0.40390335839173097
pc2 -0.1833868760203309 0.2872206893848648
pc3 -0.1365018740401349 0.29926606531935634
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-function-to-visualise-3d-projection">
<h3>Create function to visualise 3D projection<a class="headerlink" href="#create-function-to-visualise-3d-projection" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_3d_principal_component_points</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colours</span><span class="p">,</span> <span class="n">column_to_colour_cluster_with</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">pca_centroid_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()):</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

    <span class="c1"># title the axes</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Principal Component 3&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="c1"># set limits on the plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># plot the points</span>
    <span class="k">for</span> <span class="n">target</span><span class="p">,</span> <span class="n">colour</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colours</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pc1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">column_to_colour_cluster_with</span> <span class="o">==</span> <span class="n">target</span><span class="p">],</span> <span class="n">pc2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">column_to_colour_cluster_with</span> <span class="o">==</span> <span class="n">target</span><span class="p">],</span> <span class="n">pc3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">column_to_colour_cluster_with</span> <span class="o">==</span> <span class="n">target</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pca_centroid_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pca_centroid_df</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">],</span> <span class="n">pca_centroid_df</span><span class="p">[</span><span class="s1">&#39;PC2&#39;</span><span class="p">],</span> <span class="n">pca_centroid_df</span><span class="p">[</span><span class="s1">&#39;PC3&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
        
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-original-data">
<h3>Plot the original data<a class="headerlink" href="#plot-the-original-data" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>

<span class="n">plot_3d_principal_component_points</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colours</span><span class="p">,</span> <span class="n">all_rows</span><span class="p">,</span> <span class="s1">&#39;Original Data Projected Onto 3 Principal Component Axes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_159_0.png" src="_images/Clustering_159_0.png" />
</div>
</div>
</div>
<div class="section" id="plot-the-data-colouring-the-different-clusters">
<h3>Plot the data colouring the different clusters<a class="headerlink" href="#plot-the-data-colouring-the-different-clusters" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>

<span class="n">plot_3d_principal_component_points</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colours</span><span class="p">,</span> <span class="n">cluster</span><span class="p">,</span> <span class="s1">&#39;Clusters Produced by KMeans Algorithm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_161_0.png" src="_images/Clustering_161_0.png" />
</div>
</div>
</div>
<div class="section" id="plot-the-data-colouring-the-different-clusters-plotting-their-centroids">
<h3>Plot the data colouring the different clusters &amp; plotting their centroids<a class="headerlink" href="#plot-the-data-colouring-the-different-clusters-plotting-their-centroids" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lime&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>

<span class="n">plot_3d_principal_component_points</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colours</span><span class="p">,</span> <span class="n">cluster</span><span class="p">,</span> <span class="s1">&#39;Clusters Produced by KMeans Algorithm with their Centroids&#39;</span><span class="p">,</span> <span class="n">pca_centroid_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_163_0.png" src="_images/Clustering_163_0.png" />
</div>
</div>
</div>
<div class="section" id="plot-the-data-colouring-the-different-groups">
<h3>Plot the data colouring the different groups<a class="headerlink" href="#plot-the-data-colouring-the-different-groups" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="s1">&#39;old&#39;</span><span class="p">]</span>
<span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>

<span class="n">plot_3d_principal_component_points</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">colours</span><span class="p">,</span><span class="n">group</span><span class="p">,</span> <span class="s1">&#39;Original Data Segmented into Age Groups&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_165_0.png" src="_images/Clustering_165_0.png" />
</div>
</div>
<p>=============================================================</p>
</div>
</div>
</div>
<div class="section" id="analyse-these-6-clusters">
<h1>11. Analyse these 6 clusters<a class="headerlink" href="#analyse-these-6-clusters" title="Permalink to this headline">¶</a></h1>
<p>=============================================================</p>
<div class="section" id="a-see-how-the-old-and-young-fall-into-these-clusters">
<h2>a.) See how the ‘old’ and ‘young’ fall into these clusters<a class="headerlink" href="#a-see-how-the-old-and-young-fall-into-these-clusters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">see_how_the_young_and_old_fall_into_the_clusters</span><span class="p">(</span><span class="n">final_full_scaled_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All</th>
      <th>Young</th>
      <th>Old</th>
    </tr>
    <tr>
      <th>Cluster</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34</td>
      <td>34</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31</td>
      <td>0</td>
      <td>31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>38</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19</td>
      <td>18</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>29</td>
      <td>0</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="b-characterising-the-clusters-based-on-their-different-cognitive-attributes">
<h2>b.) Characterising the clusters based on their different <em>cognitive attributes</em><a class="headerlink" href="#b-characterising-the-clusters-based-on-their-different-cognitive-attributes" title="Permalink to this headline">¶</a></h2>
<p>As Lili states in the paper, a subject’s performance on the IGT can be interpreted as a <em>synthesis of several different underlying psychological processes</em> [4]. As such, the parameters of the VPP model can be treated as neuro-psychologically interpretable variables. Some details on the semantics of each variable is given below:</p>
<ul class="simple">
<li><p><strong>LR</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Learning Rate</strong>: Quantifies the rate at which the subject learns through experience.</p></li>
<li><p><strong>Out_Sens</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Outcome Sensitivity</strong>: Accounts for the effects of win frequency. Subjects with a value less than 1 prefer decks with high win frequency over decks with the same long-term rewards but much less win frequency.</p></li>
<li><p><strong>Res_Cons</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Response Consistency</strong>: Quantifies the consistency of the subjects choices.</p></li>
<li><p><strong>Loss_Aver</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Loss Aversion</strong>: Responsible for the subjects sensitivity to loss relative to gains.</p></li>
<li><p><strong>Gain_Impa</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Gain Impact</strong>: Quantifies the impact of gain on the perseverance behaviour of the subject.</p></li>
<li><p><strong>Loss_Impa</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Loss Impact</strong>: Quantifies the impact of loss on the perseverance behaviour of the subject.</p></li>
<li><p><strong>Deca_Rate</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Decay Rate</strong>: The decay parameter which controls how quickly decision makers forget their past deck choices.</p></li>
<li><p><strong>RL_weight</strong> <span class="math notranslate nohighlight">\( \Leftrightarrow \)</span> <strong>Reinforcement Learning Weight</strong>: Assumes values between 0 and 1. A low value indicates that the subject would rely less on reinforcement learning but more on the perseverance heuristic [3]. Whereas, a high value indicates the converse.</p></li>
</ul>
<p>Based on these parameters, we can examine each cluster and characterise the decision-making tendencies of the subjects in that cluster. To do this, we need the original dataset before it was standardised; we append the cluster labels to this original DataFrame below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">chosen_df</span><span class="p">,</span> <span class="n">second_cluster_labels_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>young</td>
      <td>0.038441</td>
      <td>0.630402</td>
      <td>1.207295</td>
      <td>1.050323</td>
      <td>-0.535035</td>
      <td>-1.913099</td>
      <td>0.669323</td>
      <td>0.660446</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>young</td>
      <td>0.045673</td>
      <td>0.630331</td>
      <td>1.628191</td>
      <td>0.205205</td>
      <td>-0.133367</td>
      <td>-1.423580</td>
      <td>0.427207</td>
      <td>0.719352</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>young</td>
      <td>0.045468</td>
      <td>0.602974</td>
      <td>1.395572</td>
      <td>0.383055</td>
      <td>-0.344822</td>
      <td>-1.719826</td>
      <td>0.493249</td>
      <td>0.688723</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>young</td>
      <td>0.035789</td>
      <td>0.635677</td>
      <td>1.067831</td>
      <td>0.823790</td>
      <td>-0.229192</td>
      <td>-1.484455</td>
      <td>0.625835</td>
      <td>0.675971</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>young</td>
      <td>0.060655</td>
      <td>0.636276</td>
      <td>1.802964</td>
      <td>0.329246</td>
      <td>-0.616020</td>
      <td>-2.561017</td>
      <td>0.439912</td>
      <td>0.655563</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="create-functions-to-help-analyse-parameters">
<h3>Create functions to help analyse parameters<a class="headerlink" href="#create-functions-to-help-analyse-parameters" title="Permalink to this headline">¶</a></h3>
<p>The below functions will be useful for this piece of analysis. The first extracts the subjects from a specified cluster and provides a breakdown of the distribution of their parameters. While the second plots the distributions of each variable in a cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">analyse_cluster_params</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cluster_label</span><span class="p">):</span>
    <span class="n">cluster_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cluster_label</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cluster_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_cluster_params</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cluster_label</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
    <span class="n">cluster_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">cluster_label</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cluster_df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cluster_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="summary-statistics-for-entire-subject-group">
<h3>Summary statistics for entire subject group<a class="headerlink" href="#summary-statistics-for-entire-subject-group" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
      <td>153.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.070824</td>
      <td>0.560575</td>
      <td>1.329323</td>
      <td>0.952138</td>
      <td>0.460940</td>
      <td>-0.720379</td>
      <td>0.406367</td>
      <td>0.622995</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.064683</td>
      <td>0.111139</td>
      <td>0.198041</td>
      <td>0.580621</td>
      <td>1.185591</td>
      <td>1.102656</td>
      <td>0.187483</td>
      <td>0.066657</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.027454</td>
      <td>0.352471</td>
      <td>0.879707</td>
      <td>0.193857</td>
      <td>-2.977630</td>
      <td>-2.912838</td>
      <td>0.042780</td>
      <td>0.452978</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.038294</td>
      <td>0.448811</td>
      <td>1.202790</td>
      <td>0.528927</td>
      <td>-0.287230</td>
      <td>-1.634716</td>
      <td>0.256420</td>
      <td>0.569390</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.050247</td>
      <td>0.590334</td>
      <td>1.316736</td>
      <td>0.760613</td>
      <td>0.593115</td>
      <td>-0.779120</td>
      <td>0.439912</td>
      <td>0.640917</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.078495</td>
      <td>0.646090</td>
      <td>1.428836</td>
      <td>1.292569</td>
      <td>1.419412</td>
      <td>0.137599</td>
      <td>0.565139</td>
      <td>0.675971</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.617431</td>
      <td>0.818137</td>
      <td>1.938694</td>
      <td>2.698527</td>
      <td>2.559126</td>
      <td>1.583109</td>
      <td>0.858421</td>
      <td>0.744017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="analsye-cluster-0">
<h3>Analsye Cluster 0<a class="headerlink" href="#analsye-cluster-0" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyse_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
      <td>34.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.044930</td>
      <td>0.618968</td>
      <td>1.475779</td>
      <td>0.816085</td>
      <td>-0.690345</td>
      <td>-1.772467</td>
      <td>0.549555</td>
      <td>0.662408</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.009610</td>
      <td>0.055746</td>
      <td>0.214690</td>
      <td>0.433378</td>
      <td>0.811496</td>
      <td>0.576240</td>
      <td>0.086004</td>
      <td>0.039829</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.027454</td>
      <td>0.514825</td>
      <td>1.144924</td>
      <td>0.205205</td>
      <td>-2.977630</td>
      <td>-2.750683</td>
      <td>0.327646</td>
      <td>0.559136</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.037697</td>
      <td>0.584808</td>
      <td>1.296579</td>
      <td>0.431615</td>
      <td>-1.058930</td>
      <td>-2.132671</td>
      <td>0.488916</td>
      <td>0.641616</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.045361</td>
      <td>0.623354</td>
      <td>1.422935</td>
      <td>0.718892</td>
      <td>-0.534546</td>
      <td>-1.810896</td>
      <td>0.571731</td>
      <td>0.663733</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.051248</td>
      <td>0.640286</td>
      <td>1.632197</td>
      <td>1.262242</td>
      <td>-0.086096</td>
      <td>-1.372874</td>
      <td>0.598075</td>
      <td>0.687539</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.064735</td>
      <td>0.757811</td>
      <td>1.938694</td>
      <td>1.634251</td>
      <td>0.501664</td>
      <td>-0.111529</td>
      <td>0.685362</td>
      <td>0.721415</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plot_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_181_0.png" src="_images/Clustering_181_0.png" />
</div>
</div>
<p>There are 34 subjects in this cluster, all of which are aged between 18 and 34 years (<em>group=’young’</em>). The mean Outcome Sensitivity parameter of this group was 0.62; this indicates that subjects in this cluster prefered decks with high win frequency over decks with the same long-term rewards but much less win frequency. These subjects were less sensitive to win frequency than other clusters.</p>
<p>The Gain and Loss Impact parameters also reveal some interesting characteristics of subjects in the cluster. With both distributions mainly encompassing negative values, this indicates that the feedback subjects received from deck choices, both good and bad, reinforced a tendency to switch from the chosen deck [3]. This coincides with the subjects tendency to <em>chase</em> high win frequency decks mentioned above.</p>
</div>
<div class="section" id="analsye-cluster-1">
<h3>Analsye Cluster 1<a class="headerlink" href="#analsye-cluster-1" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyse_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.098109</td>
      <td>0.451529</td>
      <td>1.308560</td>
      <td>0.846925</td>
      <td>1.627925</td>
      <td>0.447691</td>
      <td>0.139977</td>
      <td>0.546874</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.050250</td>
      <td>0.033889</td>
      <td>0.095166</td>
      <td>0.391407</td>
      <td>0.492441</td>
      <td>0.717514</td>
      <td>0.088690</td>
      <td>0.037163</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.036796</td>
      <td>0.378060</td>
      <td>1.150260</td>
      <td>0.430973</td>
      <td>0.635000</td>
      <td>-1.274963</td>
      <td>0.042780</td>
      <td>0.476973</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.064879</td>
      <td>0.437173</td>
      <td>1.227498</td>
      <td>0.571881</td>
      <td>1.228491</td>
      <td>-0.093730</td>
      <td>0.077570</td>
      <td>0.526487</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.083711</td>
      <td>0.447644</td>
      <td>1.295686</td>
      <td>0.717312</td>
      <td>1.566568</td>
      <td>0.550330</td>
      <td>0.104735</td>
      <td>0.546331</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.113639</td>
      <td>0.457205</td>
      <td>1.400418</td>
      <td>0.976864</td>
      <td>2.035408</td>
      <td>0.964493</td>
      <td>0.169572</td>
      <td>0.568558</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.244435</td>
      <td>0.541667</td>
      <td>1.464403</td>
      <td>2.211883</td>
      <td>2.559126</td>
      <td>1.583109</td>
      <td>0.415134</td>
      <td>0.611367</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plot_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_185_0.png" src="_images/Clustering_185_0.png" />
</div>
</div>
<p>The second cluster contains thirty one subjects; all aged between 65 and 88 years old (<em>group=’old’</em>). We can likely expect some different characteristics between this cluster and the last due to the age difference of the subjects.</p>
<p>The standard deviation of the Learning Rate parameter of this cluster indicates that there is much more variability in the learning rates of the subjects in this cluster than in the last. The slightly higher values, on average, displayed in this cluster indicate that the most recent outcome has a large influence on the expectancy of the chosen deck and <em>forgetting is more rapid</em> [3].</p>
<p>The other notable differences in this cluster compared to the last is in the Gain Impact and Decay Rate parameters. Feedback, for subjects in this cluster, was far more likely to reinforce a tendency to persevere on the same deck on the next trial compared to subjects in the first cluster; as indicated by the much higher average Gain Impact value. The much lower average Decay Rate for subjects in this cluster however indicates rapid forgetting and a strong recency effect. This is probably to be expected based on age and Lili also makes this observation in the paper stating that the mean decay rate for subjects in older group is lower than that of the younger group [4].</p>
</div>
<div class="section" id="analsye-cluster-2">
<h3>Analsye Cluster 2<a class="headerlink" href="#analsye-cluster-2" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyse_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>38.000000</td>
      <td>38.000000</td>
      <td>38.000000</td>
      <td>38.000000</td>
      <td>38.000000</td>
      <td>38.000000</td>
      <td>38.000000</td>
      <td>38.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.037155</td>
      <td>0.647844</td>
      <td>1.118889</td>
      <td>0.854820</td>
      <td>0.753236</td>
      <td>-0.428627</td>
      <td>0.491517</td>
      <td>0.665002</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.004996</td>
      <td>0.032998</td>
      <td>0.107184</td>
      <td>0.341363</td>
      <td>0.920465</td>
      <td>0.819311</td>
      <td>0.121305</td>
      <td>0.021714</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.029639</td>
      <td>0.566149</td>
      <td>0.879707</td>
      <td>0.325143</td>
      <td>-1.619562</td>
      <td>-1.826556</td>
      <td>0.298920</td>
      <td>0.630466</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.033137</td>
      <td>0.626812</td>
      <td>1.058415</td>
      <td>0.605547</td>
      <td>-0.099744</td>
      <td>-1.091075</td>
      <td>0.402615</td>
      <td>0.644570</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.036932</td>
      <td>0.650220</td>
      <td>1.098954</td>
      <td>0.812733</td>
      <td>0.944684</td>
      <td>-0.535138</td>
      <td>0.480873</td>
      <td>0.662299</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.039418</td>
      <td>0.669804</td>
      <td>1.183144</td>
      <td>1.107709</td>
      <td>1.497192</td>
      <td>0.032327</td>
      <td>0.578308</td>
      <td>0.681603</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.049586</td>
      <td>0.716560</td>
      <td>1.349812</td>
      <td>1.531198</td>
      <td>2.059571</td>
      <td>1.252367</td>
      <td>0.858421</td>
      <td>0.701119</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plot_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_189_0.png" src="_images/Clustering_189_0.png" />
</div>
</div>
<p>The 38 subjects in this cluster, again, are all in the ‘young’ group. They exhibited very similar characteristics to the ‘young’ subjects in cluster 0 but there are a few things which set these clusters apart.</p>
<ul class="simple">
<li><p>The most notable difference is in the Decay Rate parameter. Subjects in this cluster tended to have lower Decay Rates with a lower mean value, which could have been even lower due to the presence of one or two outliers. This indicates that subjects in this cluster forgot their past deck choices quicker than those is cluster 0, and exhibited a stronger recency effect.</p></li>
<li><p>Interestingly, subjects in this group were more likely to persevere with the same deck choice when positive feedback was received, as indicated by the higher average Gain Impact parameter, compared to cluster 0.</p></li>
<li><p>The subjects were also less likely to switch decks upon receiving negative feedback (Loss Impact) compared to the ‘young’ subjects in cluster 0. The higher average value of Loss Impact is indicative of this.</p></li>
</ul>
</div>
<div class="section" id="analsye-cluster-3">
<h3>Analsye Cluster 3<a class="headerlink" href="#analsye-cluster-3" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyse_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.481673</td>
      <td>0.409255</td>
      <td>1.586845</td>
      <td>0.358229</td>
      <td>-0.254669</td>
      <td>-1.730171</td>
      <td>0.156310</td>
      <td>0.621025</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.191991</td>
      <td>0.014745</td>
      <td>0.288681</td>
      <td>0.084110</td>
      <td>0.111644</td>
      <td>0.134995</td>
      <td>0.030132</td>
      <td>0.043265</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.345916</td>
      <td>0.398828</td>
      <td>1.382717</td>
      <td>0.298755</td>
      <td>-0.333613</td>
      <td>-1.825627</td>
      <td>0.135004</td>
      <td>0.590432</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.413794</td>
      <td>0.404042</td>
      <td>1.484781</td>
      <td>0.328492</td>
      <td>-0.294141</td>
      <td>-1.777899</td>
      <td>0.145657</td>
      <td>0.605729</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.481673</td>
      <td>0.409255</td>
      <td>1.586845</td>
      <td>0.358229</td>
      <td>-0.254669</td>
      <td>-1.730171</td>
      <td>0.156310</td>
      <td>0.621025</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.549552</td>
      <td>0.414468</td>
      <td>1.688909</td>
      <td>0.387967</td>
      <td>-0.215196</td>
      <td>-1.682444</td>
      <td>0.166964</td>
      <td>0.636322</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.617431</td>
      <td>0.419681</td>
      <td>1.790974</td>
      <td>0.417704</td>
      <td>-0.175724</td>
      <td>-1.634716</td>
      <td>0.177617</td>
      <td>0.651618</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plots are not needed here</span>

<span class="n">df_final</span><span class="p">[</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>108</th>
      <td>old</td>
      <td>0.617431</td>
      <td>0.398828</td>
      <td>1.382717</td>
      <td>0.298755</td>
      <td>-0.175724</td>
      <td>-1.634716</td>
      <td>0.177617</td>
      <td>0.590432</td>
      <td>3</td>
    </tr>
    <tr>
      <th>145</th>
      <td>old</td>
      <td>0.345916</td>
      <td>0.419681</td>
      <td>1.790974</td>
      <td>0.417704</td>
      <td>-0.333613</td>
      <td>-1.825627</td>
      <td>0.135004</td>
      <td>0.651618</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>There are only two subjects in this cluster, both from the ‘old’ group. It is unusual for a cluster this small to exist and it poses the question of what sets these two subjects apart from the other clusters?</p>
<ul class="simple">
<li><p>It appears the Learning Rate of these two ‘old’ subjects is considerably higher than the average values in cluster 1  and cluster 5 of 0.098 and 0.094 respectively. So for these two subjects in particular, the most recent outcome had a large influence on the expectancy of the chosen deck and forgetting was more rapid [3]. These two values for learning rate are actually the highest values in the entire dataset, meaning these two subjects in particular forgot their previous choices more rapidly.</p></li>
<li><p>The Response Consistency of 1.38 for the first subject was similar to the values present in the other two ‘old’ clusters. But the value of 1.79 for the second subject was actually the highest Response Consistency among all ‘old’ subjects. This indicates a high consistency in the choices of this particular subject.</p></li>
</ul>
</div>
<div class="section" id="analsye-cluster-4">
<h3>Analsye Cluster 4<a class="headerlink" href="#analsye-cluster-4" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyse_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>19.000000</td>
      <td>19.000000</td>
      <td>19.000000</td>
      <td>19.000000</td>
      <td>19.000000</td>
      <td>19.000000</td>
      <td>19.000000</td>
      <td>19.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.061108</td>
      <td>0.673738</td>
      <td>1.362218</td>
      <td>2.112953</td>
      <td>1.176818</td>
      <td>-0.209339</td>
      <td>0.503616</td>
      <td>0.676144</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.037106</td>
      <td>0.078943</td>
      <td>0.131509</td>
      <td>0.318653</td>
      <td>0.609554</td>
      <td>0.859685</td>
      <td>0.119095</td>
      <td>0.038725</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.035290</td>
      <td>0.519401</td>
      <td>1.168612</td>
      <td>1.489912</td>
      <td>-0.135692</td>
      <td>-1.744153</td>
      <td>0.254134</td>
      <td>0.581288</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.049401</td>
      <td>0.619825</td>
      <td>1.263198</td>
      <td>1.914642</td>
      <td>0.907488</td>
      <td>-1.003000</td>
      <td>0.442941</td>
      <td>0.658752</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.052410</td>
      <td>0.672577</td>
      <td>1.316736</td>
      <td>2.153174</td>
      <td>1.187441</td>
      <td>-0.212460</td>
      <td>0.516845</td>
      <td>0.682027</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.057140</td>
      <td>0.747180</td>
      <td>1.436604</td>
      <td>2.319864</td>
      <td>1.498312</td>
      <td>0.484873</td>
      <td>0.597212</td>
      <td>0.701697</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.209782</td>
      <td>0.818137</td>
      <td>1.693704</td>
      <td>2.698527</td>
      <td>2.531642</td>
      <td>0.940470</td>
      <td>0.695701</td>
      <td>0.744017</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>19 subjects make up the fifth cluster and interestingly, there is one ‘old’ subject in this cluster while the rest of the subjects are from the ‘young’ group. We will extract the subject from the ‘old’ group for reference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_final</span><span class="p">[(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;Cluster&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;old&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
      <th>Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>136</th>
      <td>old</td>
      <td>0.209782</td>
      <td>0.519401</td>
      <td>1.263331</td>
      <td>1.926615</td>
      <td>1.099713</td>
      <td>0.59945</td>
      <td>0.61377</td>
      <td>0.581288</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plot_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_199_0.png" src="_images/Clustering_199_0.png" />
</div>
</div>
<p>This cluster should display similar characteristics to the cluster 0 and cluster 2 as these both also contain exclusively subjects from the ‘young’ group (bar the one ‘old’ subject in this cluster, of course). The Learning Rate of subjects in this cluster was, on average, slightly lower than cluster 0 and cluster 2 (The actual mean of this parameter is skewed because of the outlier value present in the ‘old’ subject of 0.2). This indicates that subjects in this cluster placed less weight on past experiences of the chosen deck vs. the most recent selection from the deck. This also is indicative of the fact that subjects forgot past deck choices in a more gradual manner than in the other two ‘young’ groups. The most recent outcome had a smaller influence on the expectancy in the next trial, for these subjects.</p>
<p>The other most distinguishable characteristic of this cluster compared to the other ‘young’ groups was the much higher Loss Aversion tendencies of this cluster. The mean Loss Aversion parameter for subjects was 2.11 compared to 0.82 in cluster 0 and 0.85 in cluster 2. When Loss Aversion is greater than 1, the influence of a loss is greater than a gain on the subject [3]. This cluster of ‘young’ subjects, in particular, gave more weight to losses, compared to the other two ‘young’ clusters.</p>
</div>
<div class="section" id="analsye-cluster-5">
<h3>Analsye Cluster 5<a class="headerlink" href="#analsye-cluster-5" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">analyse_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>LR</th>
      <th>Out_Sens</th>
      <th>Res_Cons</th>
      <th>Loss_Aver</th>
      <th>Gain_Impa</th>
      <th>Loss_Impa</th>
      <th>Deca_Rate</th>
      <th>RL_weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>29.000000</td>
      <td>29.000000</td>
      <td>29.000000</td>
      <td>29.000000</td>
      <td>29.000000</td>
      <td>29.000000</td>
      <td>29.000000</td>
      <td>29.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.094167</td>
      <td>0.430625</td>
      <td>1.416240</td>
      <td>0.632061</td>
      <td>-0.239426</td>
      <td>-1.382996</td>
      <td>0.365205</td>
      <td>0.568425</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.042444</td>
      <td>0.035365</td>
      <td>0.140328</td>
      <td>0.363062</td>
      <td>1.053638</td>
      <td>0.787160</td>
      <td>0.138316</td>
      <td>0.058474</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.034678</td>
      <td>0.352471</td>
      <td>1.170308</td>
      <td>0.193857</td>
      <td>-2.576726</td>
      <td>-2.912838</td>
      <td>0.184651</td>
      <td>0.452978</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.065054</td>
      <td>0.410881</td>
      <td>1.335872</td>
      <td>0.391450</td>
      <td>-0.736174</td>
      <td>-2.108210</td>
      <td>0.242197</td>
      <td>0.527814</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.093528</td>
      <td>0.440661</td>
      <td>1.403124</td>
      <td>0.567275</td>
      <td>0.206315</td>
      <td>-1.378078</td>
      <td>0.341295</td>
      <td>0.569390</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.111220</td>
      <td>0.454395</td>
      <td>1.505701</td>
      <td>0.715643</td>
      <td>0.455003</td>
      <td>-0.776568</td>
      <td>0.502327</td>
      <td>0.622562</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.217324</td>
      <td>0.505871</td>
      <td>1.688776</td>
      <td>1.681583</td>
      <td>1.268844</td>
      <td>0.302832</td>
      <td>0.600929</td>
      <td>0.661746</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plot_cluster_params</span><span class="p">(</span><span class="n">df_final</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Clustering_203_0.png" src="_images/Clustering_203_0.png" />
</div>
</div>
<p>There are 29 subjects in the final cluster, all from the ‘old’ group. They exhibit very similar characteristics to the subjects in cluster 1, which also exclusively contains ‘old’ subjects. This is to be expected. They do however, share some subtle differences with this other cluster.</p>
<ul class="simple">
<li><p>The Loss Aversion of subjects in this cluster is slightly lower, on average. They were affected less by losses relative to gains than the other group, with a slightly lower mean value.</p></li>
<li><p>The Gain and Loss Impacts respectively were both, on average, much lower for subjects in this cluster comaperd to those in cluster 1. These lower, negative values indicate that the feedback received for their deck choices reinforces a tendency to switch from the chosen deck.</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Intro_and_Desc_of_Data.html" title="previous page">INTRODUCTION AND DESCRIPTION OF DATASET</a>
    <a class='right-next' id="next-link" href="Summary_Conclusion.html" title="next page">Summary</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>